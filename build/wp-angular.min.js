angular.module("wp",["wp.services","ngResource","ngSanitize"]).directive("havePosts",["wpQuery",function(e){return{restrict:"E",replace:!0,transclude:!0,scope:{postType:"@",postId:"@",apiRoot:"@",perPage:"@",offset:"@"},controller:["$scope",function(t){t.load=function(){1!=t.busy&&(t.busy=!0,t.postId?e(t.apiRoot).get(t.query).$promise.then(function(e){t.busy=!0,t.posts.push(e)}):e(t.apiRoot).query(t.query).$promise.then(function(e){e.length&&(t.posts=t.posts.concat(e),t.busy=!1,t.query.offset=parseInt(t.query.offset)+parseInt(t.perPage))}))}}],compile:function(e,t,r){return{pre:function(e,t,r,i){e.posts=[],e.postId?e.query={endpoint:e.postType,id:e.postId}:(e.perPage||(e.perPage=10),e.offset||(e.offset=0),e.query={endpoint:e.postType,per_page:e.perPage,offset:e.offset,"filter[orderby]":"date","filter[order]":"DESC",_embed:!0}),e.load()}}},template:'<div class="have-posts"><div infinite-scroll="load()" infinite-scroll-distance="2"><article class="{{ postType }} post-{{ post.id }}" ng-repeat="post in posts"><div ng-transclude></div></article></div></div>'}}]).directive("theTitle",["$sce",function(e){return{restrict:"E",replace:!0,require:"^havePosts",transclude:!0,compile:function(e,t,r){return{post:function(e,r,i,n){var s=e.$parent.post;e.title=s.title.rendered,t.href?(e.permalink=t.href,e.permalink=e.permalink.replace(":id",s.id),e.permalink=e.permalink.replace(":slug",s.slug)):e.permalink=""}}},template:function(e,t){return t.href?'<div class="the-title"><a ng-href="{{ permalink }}" ng-bind-html="title">{{ title }}</a></div>':'<div class="the-title" ng-bind-html="title">{{ title }}</div>'}}}]).directive("theContent",["$sce",function(e){return{restrict:"E",replace:!0,require:"^havePosts",compile:function(t,r,i){return{post:function(t,r,i,n){var s=t.$parent.post;t.content=e.trustAsHtml(s.content.rendered)}}},template:'<div class="the-content" ng-bind-html="content">{{ content }}</div>'}}]).directive("thePostThumbnail",[function(){return{restrict:"E",replace:!0,require:"^havePosts",compile:function(e,t,r){return{post:function(e,r,i,n){i.size||(i.size="post-thumbnail");var s,o="https://api.w.org/featuredmedia",a=e.$parent.post._embedded;a&&a[o]&&a[o].length&&(s=a[o][0].media_details.sizes[i.size]?a[o][0].media_details.sizes[i.size].source_url:a[o][0].media_details.sizes.full.source_url),s&&(e.image_src=s);var p=e.$parent.post;t.href?(e.permalink=t.href,e.permalink=e.permalink.replace(":id",p.id),e.permalink=e.permalink.replace(":slug",p.slug)):e.permalink=""}}},template:function(e,t){return t.href?'<div class="the-post-thumbnail"><a ng-href="{{ permalink }}"><img ng-src="{{ image_src }}"></a></div>':'<div class="the-post-thumbnail"><img ng-src="{{ image_src }}"></div>'}}}]).directive("theId",[function(){return{restrict:"E",replace:!0,require:"^havePosts",compile:function(e,t,r){return{post:function(e,t,r,i){e.post_id=e.$parent.post.id}}},template:'<div class="the-id">{{ post_id }}</div>'}}]).directive("theExcerpt",["$sce",function(e){return{restrict:"E",replace:!0,require:"^havePosts",compile:function(t,r,i){return{post:function(t,r,i,n){var s=t.$parent.post;t.excerpt=e.trustAsHtml(s.excerpt.rendered)}}},template:'<div class="the-excerpt" ng-bind-html="excerpt">{{ excerpt }}</div>'}}]).directive("theDate",[function(){return{restrict:"E",replace:!0,require:"^havePosts",compile:function(e,t,r){return{post:function(e,t,r,i){r.format?e.format=r.format:e.format="yyyy/MM/ddTH:mm:ssZ";var n=e.$parent.post.date_gmt+"Z";e.date=n}}},template:'<div class="the-date">{{ date | date: format }}</div>'}}]),angular.module("wp.services",["ngResource"]).factory("wpQuery",["$resource",function(e){return function(t){var r=t+"/:endpoint/:id",i={endpoint:"@endpoint",id:"@id"},n={};return e(r,i,n)}}]);