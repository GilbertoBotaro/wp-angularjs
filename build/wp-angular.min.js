var wp=angular.module("wp",["wp.services","ngResource","ngSanitize"]);wp.directive("havePosts",["wpQuery",function(e){return{restrict:"E",replace:!0,transclude:!0,scope:{postType:"@",postId:"@",apiRoot:"@",perPage:"@",offset:"@"},controller:["$scope",function(t){t.load=function(){1!=t.busy&&(t.busy=!0,e(t.apiRoot).query(t.query).$promise.then(function(e){e.length&&(t.posts=t.posts.concat(e),t.busy=!1,t.query.offset=parseInt(t.query.offset)+parseInt(t.perPage))}))}}],compile:function(t,r,i){return{pre:function(t,r,i,n){t.posts=[],t.postId?(t.query={endpoint:t.postType,id:t.postId},e(t.apiRoot).get(t.query).$promise.then(function(e){t.posts.push(e)})):(t.perPage||(t.perPage=10),t.offset||(t.offset=0),t.query={endpoint:t.postType,per_page:t.perPage,offset:t.offset,"filter[orderby]":"date","filter[order]":"DESC",_embed:!0},t.load())}}},template:'<div class="have-posts"><div infinite-scroll="load()" infinite-scroll-distance="2"><article class="{{ postType }} post-{{ post.id }}" ng-repeat="post in posts"><div ng-transclude></div></article></div></div>'}}]),wp.directive("theTitle",["$sce",function(e){return{restrict:"E",replace:!0,require:"^havePosts",transclude:!0,compile:function(e,t,r){return{post:function(e,r,i,n){var s=e.$parent.post;e.title=s.title.rendered,t.href?(e.permalink=t.href,e.permalink=e.permalink.replace(":id",s.id),e.permalink=e.permalink.replace(":slug",s.slug)):e.permalink="",r.remove("href")}}},template:function(e,t){return t.href?'<div class="the-title"><a ng-href="{{ permalink }}" ng-bind-html="title">{{ title }}</a></div>':'<div class="the-title" ng-bind-html="title">{{ title }}</div>'}}}]),wp.directive("theContent",["$sce",function(e){return{restrict:"E",replace:!0,require:"^havePosts",compile:function(t,r,i){return{post:function(t,r,i,n){var s=t.$parent.post;t.content=e.trustAsHtml(s.content.rendered)}}},template:'<div class="the-content" ng-bind-html="content">{{ content }}</div>'}}]),wp.directive("thePostThumbnail",[function(){return{restrict:"E",replace:!0,require:"^havePosts",compile:function(e,t,r){return{post:function(e,t,r,i){r.size||(r.size="post-thumbnail");var n,s="https://api.w.org/featuredmedia",o=e.$parent.post._embedded;o&&o[s]&&o[s].length&&(n=o[s][0].media_details.sizes[r.size]?o[s][0].media_details.sizes[r.size].source_url:o[s][0].media_details.sizes.full.source_url),n&&(e.image_src=n)}}},template:'<div class="the-post-thumbnail"><img ng-src="{{ image_src }}"></div>'}}]),wp.directive("theId",[function(){return{restrict:"E",replace:!0,require:"^havePosts",compile:function(e,t,r){return{post:function(e,t,r,i){e.post_id=e.$parent.post.id}}},template:'<div class="the-id">{{ post_id }}</div>'}}]),wp.directive("theExcerpt",["$sce",function(e){return{restrict:"E",replace:!0,require:"^havePosts",compile:function(t,r,i){return{post:function(t,r,i,n){var s=t.$parent.post;t.excerpt=e.trustAsHtml(s.excerpt.rendered)}}},template:'<div class="the-excerpt" ng-bind-html="excerpt">{{ excerpt }}</div>'}}]),wp.directive("theDate",[function(){return{restrict:"E",replace:!0,require:"^havePosts",compile:function(e,t,r){return{post:function(e,t,r,i){r.format?e.format=r.format:e.format="yyyy/MM/ddTH:mm:ssZ";var n=e.$parent.post.date_gmt+"Z";e.date=n}}},template:'<div class="the-date">{{ date | date: format }}</div>'}}]),angular.module("wp.services",["ngResource"]).factory("wpQuery",["$resource",function(e){return function(t){var r=t+"/:endpoint/:id",i={endpoint:"@endpoint",id:"@id"},n={};return e(r,i,n)}}]);